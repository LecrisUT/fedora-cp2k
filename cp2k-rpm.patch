diff -up cp2k-2.6.0/arch/Linux-x86-64-gfortran.popt.r cp2k-2.6.0/arch/Linux-x86-64-gfortran.popt
--- cp2k-2.6.0/arch/Linux-x86-64-gfortran.popt.r	2014-10-30 09:11:05.836895000 +0100
+++ cp2k-2.6.0/arch/Linux-x86-64-gfortran.popt	2015-03-17 22:45:20.056977801 +0100
@@ -1,8 +1,8 @@
 # Tested with: GFortran 4.9.1, MPICH 3.1, LAPACK 3.5.0, ScaLAPACK 2.0.2
 CC         = gcc
 CPP        =
-FC         = mpif90
-LD         = mpif90
+FC         = mpifort
+LD         = mpifort
 AR         = ar -r
 ACML_INC   = $(ACMLPATH)/include
 ACML_LIB   = $(ACMLPATH)/lib
@@ -13,18 +13,20 @@ LIBINT_LIB = $(GCC_DIR)/libint/1.1.4-LAR
 LIBXC_INC  = $(GCC_DIR)/libxc/2.2.0-gnu/include
 LIBXC_LIB  = $(GCC_DIR)/libxc/2.2.0-gnu/lib64
 DFLAGS     = -D__FFTW3 -D__LIBINT -D__LIBXC2\
-             -D__LIBINT_MAX_AM=7 -D__LIBDERIV_MAX_AM1=6 -D__MAX_CONTR=4\
+             -D__LIBINT_MAX_AM=@LIBINT_MAX_AM@ -D__LIBDERIV_MAX_AM1=@LIBDERIV_MAX_AM@ -D__MAX_CONTR=4\
+             -D__ELPA\
              -D__parallel -D__SCALAPACK
 CPPFLAGS   =
-FCFLAGS    = $(DFLAGS) -O2 -ffast-math -ffree-form -ffree-line-length-none\
+OPTFLAGS   = -O2 -ffast-math\
              -ftree-vectorize -funroll-loops\
              -mtune=native\
              -I$(ACML_INC) -I$(FFTW_INC) -I$(LIBINT_INC) -I$(LIBXC_INC)
-LDFLAGS    = $(FCFLAGS) -static-libgfortran
-LIBS       = $(MPI_LIBRARY_PATH)/libscalapack-gnu.a\
-             $(ACML_LIB)/libacml.a\
-             $(FFTW_LIB)/libfftw3.a\
-             $(LIBXC_LIB)/libxcf90.a\
-             $(LIBXC_LIB)/libxc.a\
-             $(LIBINT_LIB)/libderiv.a\
-             $(LIBINT_LIB)/libint.a
+FCFLAGS    = $(DFLAGS) $(OPTFLAGS) -ffree-form -ffree-line-length-none
+LDFLAGS    = $(FCFLAGS)
+LIBS       = -lelpa \
+             -lscalapack -lmpiblacsF77init -lmpiblacs -lmpiblacsCinit -lstdc++\
+             -lsatlas\
+             -lfftw3\
+             -lxc\
+             -lderiv\
+             -lint
diff -up cp2k-2.6.0/arch/Linux-x86-64-gfortran.psmp.r cp2k-2.6.0/arch/Linux-x86-64-gfortran.psmp
--- cp2k-2.6.0/arch/Linux-x86-64-gfortran.psmp.r	2014-12-22 01:17:03.067670000 +0100
+++ cp2k-2.6.0/arch/Linux-x86-64-gfortran.psmp	2015-03-17 22:45:26.986086166 +0100
@@ -1,8 +1,8 @@
 # Tested with: GFortran 4.9.1, MPICH 3.1, LAPACK 3.5.0, ScaLAPACK 2.0.2
 CC         = gcc
 CPP        =
-FC         = mpif90
-LD         = mpif90
+FC         = mpifort
+LD         = mpifort
 AR         = ar -r
 ACML_INC   = $(ACMLPATH)/include
 ACML_LIB   = $(ACMLPATH)/lib
@@ -13,19 +13,20 @@ LIBINT_LIB = $(GCC_DIR)/libint/1.1.4-LAR
 LIBXC_INC  = $(GCC_DIR)/libxc/2.2.0-gnu/include
 LIBXC_LIB  = $(GCC_DIR)/libxc/2.2.0-gnu/lib64
 DFLAGS     = -D__FFTW3 -D__LIBINT -D__LIBXC2\
-             -D__LIBINT_MAX_AM=7 -D__LIBDERIV_MAX_AM1=6 -D__MAX_CONTR=4\
+             -D__LIBINT_MAX_AM=@LIBINT_MAX_AM@ -D__LIBDERIV_MAX_AM1=@LIBDERIV_MAX_AM@ -D__MAX_CONTR=4\
+             -D__ELPA\
              -D__parallel -D__SCALAPACK
 CPPFLAGS   =
-FCFLAGS    = $(DFLAGS) -O2 -ffast-math -ffree-form -ffree-line-length-none\
-             -fopenmp -ftree-vectorize -funroll-loops\
+OPTFLAGS   = -O2 -ffast-math -ftree-vectorize -funroll-loops\
              -mtune=native\
              -I$(ACML_INC) -I$(FFTW_INC) -I$(LIBINT_INC) -I$(LIBXC_INC)
-LDFLAGS    = $(FCFLAGS) -static-libgfortran
-LIBS       = $(MPI_LIBRARY_PATH)/libscalapack-gnu.a\
-             $(ACML_LIB)/libacml.a\
-             $(FFTW_LIB)/libfftw3.a\
-             $(FFTW_LIB)/libfftw3_threads.a\
-             $(LIBXC_LIB)/libxcf90.a\
-             $(LIBXC_LIB)/libxc.a\
-             $(LIBINT_LIB)/libderiv.a\
-             $(LIBINT_LIB)/libint.a
+FCFLAGS    = $(DFLAGS) $(OPTFLAGS) -fopenmp -ffree-form -ffree-line-length-none
+LDFLAGS    = $(FCFLAGS)
+LIBS       = -lelpa \
+             -lscalapack -lmpiblacsF77init -lmpiblacs -lmpiblacsCinit -lstdc++\
+             -lsatlas\
+             -lfftw3\
+             -lfftw3_omp\
+             -lxc\
+             -lderiv\
+             -lint
diff -up cp2k-2.6.0/arch/Linux-x86-64-gfortran.sopt.r cp2k-2.6.0/arch/Linux-x86-64-gfortran.sopt
--- cp2k-2.6.0/arch/Linux-x86-64-gfortran.sopt.r	2014-12-22 01:17:03.067670000 +0100
+++ cp2k-2.6.0/arch/Linux-x86-64-gfortran.sopt	2015-03-17 22:45:04.022727041 +0100
@@ -13,17 +13,16 @@ LIBINT_LIB = $(GCC_DIR)/libint/1.1.4-LAR
 LIBXC_INC  = $(GCC_DIR)/libxc/2.2.0-gnu/include
 LIBXC_LIB  = $(GCC_DIR)/libxc/2.2.0-gnu/lib64
 DFLAGS     = -D__FFTW3 -D__LIBINT -D__LIBXC2\
-             -D__LIBINT_MAX_AM=7 -D__LIBDERIV_MAX_AM1=6 -D__MAX_CONTR=4
+             -D__LIBINT_MAX_AM=@LIBINT_MAX_AM@ -D__LIBDERIV_MAX_AM1=@LIBDERIV_MAX_AM@ -D__MAX_CONTR=4
 CPPFLAGS   = 
-FCFLAGS    = $(DFLAGS) -O2 -ffast-math -ffree-form -ffree-line-length-none\
+OPTFLAGS   = -O2 -ffast-math\
              -ftree-vectorize -funroll-loops\
              -mtune=native\
              -I$(ACML_INC) -I$(FFTW_INC) -I$(LIBINT_INC) -I$(LIBXC_INC)
-LDFLAGS    = $(FCFLAGS) -static-libgfortran
-LIBS       = $(ACML_LIB)/libacml.a\
-             $(FFTW_LIB)/libfftw3.a\
-             $(LIBXC_LIB)/libxcf90.a\
-             $(LIBXC_LIB)/libxc.a\
-             $(LIBINT_LIB)/libderiv.a\
-             $(LIBINT_LIB)/libint.a
-
+FCFLAGS    = $(DFLAGS) $(OPTFLAGS) -ffree-form -ffree-line-length-none
+LDFLAGS    = $(FCFLAGS)
+LIBS       = -lsatlas\
+             -lfftw3\
+             -lxc\
+             -lderiv\
+             -lint
diff -up cp2k-2.6.0/arch/Linux-x86-64-gfortran.ssmp.r cp2k-2.6.0/arch/Linux-x86-64-gfortran.ssmp
--- cp2k-2.6.0/arch/Linux-x86-64-gfortran.ssmp.r	2014-12-22 01:17:03.067670000 +0100
+++ cp2k-2.6.0/arch/Linux-x86-64-gfortran.ssmp	2015-03-17 22:45:04.022727041 +0100
@@ -13,17 +13,16 @@ LIBINT_LIB = $(GCC_DIR)/libint/1.1.4-LAR
 LIBXC_INC  = $(GCC_DIR)/libxc/2.2.0-gnu/include
 LIBXC_LIB  = $(GCC_DIR)/libxc/2.2.0-gnu/lib64
 DFLAGS     = -D__FFTW3 -D__LIBINT -D__LIBXC2\
-             -D__LIBINT_MAX_AM=7 -D__LIBDERIV_MAX_AM1=6 -D__MAX_CONTR=4
+             -D__LIBINT_MAX_AM=@LIBINT_MAX_AM@ -D__LIBDERIV_MAX_AM1=@LIBDERIV_MAX_AM@ -D__MAX_CONTR=4
 CPPFLAGS   = 
-FCFLAGS    = $(DFLAGS) -O2 -ffast-math -ffree-form -ffree-line-length-none\
-             -fopenmp -ftree-vectorize -funroll-loops\
+OPTFLAGS   = -O2 -ffast-math -ftree-vectorize -funroll-loops\
              -mtune=native\
              -I$(ACML_INC) -I$(FFTW_INC) -I$(LIBINT_INC) -I$(LIBXC_INC)
-LDFLAGS    = $(FCFLAGS) -static-libgfortran
-LIBS       = $(ACML_LIB)/libacml.a\
-             $(FFTW_LIB)/libfftw3.a\
-             $(FFTW_LIB)/libfftw3_threads.a\
-             $(LIBXC_LIB)/libxcf90.a\
-             $(LIBXC_LIB)/libxc.a\
-             $(LIBINT_LIB)/libderiv.a\
-             $(LIBINT_LIB)/libint.a
+FCFLAGS    = $(DFLAGS) $(OPTFLAGS) -fopenmp -ffree-form -ffree-line-length-none
+LDFLAGS    = $(FCFLAGS)
+LIBS       = -lsatlas\
+             -lfftw3\
+             -lfftw3_omp\
+             -lxc\
+             -lderiv\
+             -lint
diff -up cp2k-2.6.0/tools/regtesting/do_regtest.r cp2k-2.6.0/tools/regtesting/do_regtest
--- cp2k-2.6.0/tools/regtesting/do_regtest.r	2014-11-28 13:32:08.930828000 +0100
+++ cp2k-2.6.0/tools/regtesting/do_regtest	2015-03-17 22:45:04.022727041 +0100
@@ -241,8 +241,8 @@ job_max_time=${job_max_time:-"600"}
 #
 ###################################################################################
 test_types_file=${dir_base}/${cp2k_dir}/tests/TEST_TYPES
-dir_last=${dir_base}/LAST-${dir_triplet}-${cp2k_version}
-dir_out=${dir_base}/TEST-${dir_triplet}-${cp2k_version}-${datum_short}
+dir_last=${dir_base}/${cp2k_dir}/LAST-${dir_triplet}-${cp2k_version}
+dir_out=${dir_base}/${cp2k_dir}/TEST-${dir_triplet}-${cp2k_version}-${datum_short}
 changelog=${dir_last}/ChangeLog
 changelog_diff=${changelog}.diff
 changelog_new=${changelog}.new
@@ -731,6 +731,7 @@ for dir in ${dirs}; do
      # if value does not exist set to the default of 1.0E-14
      test_tolerance=`grep -v "#" TEST_FILES | ${awk} -v itest=$itest -v def_err_tol=$default_err_tolerance '{c=c+1;if (c==itest) if (NF == 3) { print $3 } else { print def_err_tol } }'`
 
+     echo "Running ${input_file}"
      output_file=${dir_out}/${dir}/${input_file}.out
      output_last=${dir_last}/${dir}/${input_file}.out
      ( ulimit -t ${job_max_time} ; ${cp2k_prefix} ${input_file} ${cp2k_postfix} &> ${output_file} ) >& /dev/null
